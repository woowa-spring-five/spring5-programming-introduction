# 빈 라이프사이클과 범위

- 스프링 컨테이너는 초기화와 종료라는 라이프사이클을 가짐

```Java
//1. 컨테이너 초기화
AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext(AppContext.class);

//2. 컨테이너에서 빈 객체를 구해서 사용
Greeter g = ctx.getBean("greeter", Greeter.class);

//3. 컨테이너 종료
ctx.close();
```

- 컨텍스트 객체를 생성 할 때, 이 시점에서 스프링 컨테이너를 초기화 한다.
- 스프링 컨테이너는 설정 클래스에서 정보를 읽어와 알맞은 빈 객체를 생성하고 각 빈을 연결(의존주입) 하는 작업을 수행한다.



- 컨테이너가 초기화되면 컨테이너를 사용할 수 있다.
  - getBean()과 같은 메서드를 이용해서 컨테이너에 보관된 빈 객체를 구할 수 있다.



- 컨테이너가 종료 될 때 빈 객체가 소멸 된다.



## 스프링 빈 객체의 라이프사이클

- 스프링 컨테이너는 빈 객체의 라이프사이클을 관리한다.
  1. 객체 생성
  2. 의존설정
  3. 초기화
  4. 소멸
- 스프링 컨테이너를 초기화할 때 스프링 컨테이너는 가장 먼저 빈 객체를 생성하고 의존을 설정한다.
  - 의존 자동 주입을 통한 의존 설정이 이 시점에 수행
- 모든 의존 설정이 완료되면 빈 객체의 초기화를 수행한다.



- InitializingBean
- DisposableBean
- 좋은예
  - 데이터베이스 커넥션 풀
    - 컨테이너를 사용하는 동안 연결을 유지하고 빈 객체를 소멸할 때 사용중인 데이터베이스 연결을 끊어야 한다.



## 빈 객체의 초기화 소멸: 커스텀 메서드

- 직접 구현한 클래스가 아닌 외부에서 제공받은 클래스를 스프링 빈 객체로 등록 할 경우
  - @Bean 태그에서 initMethod 속성과 destroyMethod를 사용
  - initMethod와 destroyMethod에 빈의 메소드를 지정해 준다.

```java
@Bean(initMethod = "connect", destroyMethod = "close")
```



## 빈 객체의 생성과 관리범위

- 별도 설정을 하지 않으면 빈은 싱글톤 범위를 갖는다.
- 프로토타입 범위의 빈도 설정 할 수 있다.
  - getBean()메서드가 매번 새로운 객체를 생성해서 리턴한다.